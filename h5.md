  a) Lab1. Tutkiminen mikä on ohjelmassa vialla ja miten se korjataan. lab1.zip

  Latasin lab1.zip, unzip ja asensin gdb

    
    sudo apt-get update
    sudo apt install gdb


Aloitin ajamalla ohjelman komennolla

      run

<img width="628" height="170" alt="kuva" src="https://github.com/user-attachments/assets/07538eec-0f71-49eb-ad06-1679a63d6ee7" />

Sieltä tuli SIGSEGV error eli tunnilta käyty virhe jossa ohjelma koettaa käyttää muistia väärästä paikasta.

Ongelmana vaikuttaa olevan rivillä 7 kohdassa

    printf("%c", (*message)+1;


Tarkastin vielä ajamalla ohjelman uudestaan ja käyttämällä backtrace komentoa, jossa näe missä on ongelmia.
<img width="635" height="196" alt="kuva" src="https://github.com/user-attachments/assets/6b9a7fab-7085-4ef8-8720-2c0165b59143" />


print_scrambled on siis ongelma ja sen alla on main functio

Siinä nähdään, että message = 0x0 eli sillä ei ole mitään arvoa (Null)

Koska nyt tiesin, että siellä on main functio halusin tarkastella sitä seuraavaksi 

Asetin breakpointin main functioon ja menin rivi riviltä läpi käyttämällä next komentoa 


<img width="717" height="370" alt="kuva" src="https://github.com/user-attachments/assets/e1c8390d-76ff-4049-a010-254269d3ca93" />



Ohjelma hajoaa kohdassa 

    print_scrambled(bad_message)

Katsoin mitä se koittaa tulostaa

<img width="216" height="58" alt="kuva" src="https://github.com/user-attachments/assets/56558767-f27d-4247-8099-c44b6a061eed" /> 

0x0 on sama kuin ei mitään (Null)


Testasin vielä että good_message toimii niin kuin pitää


<img width="321" height="56" alt="kuva" src="https://github.com/user-attachments/assets/9b262b4a-7a40-486f-a8b2-0980a15992d1" />


Ongelma on siis tuo NULL

Tässä kohtaan kävin katsomassa tehtävänannon uudestaan ja näin, että lähdekoodi on tarjottu ystävllisesti alkutehtäviin.



<img width="509" height="380" alt="kuva" src="https://github.com/user-attachments/assets/ef5c1dd3-0f9f-4777-9507-8f804ecd9b52" />


Vikana tässä koodissa on että 

    printf("%c", (*message)+1;

yritetään katsoa kohtaa NULL eli 0x0, joka epäkelpo osoite ja ohjelma hajoaa.

Yksinkertaisin ratkaisu olisi tietenkin lisäämällä testin, jos message == NULL. Lisäsin:

    
```c
if (message == NULL) {
    printf("null"\n):
    return;
}
```


<img width="648" height="508" alt="image" src="https://github.com/user-attachments/assets/bc8c90dd-0cfb-438b-aa20-c323dee59079" />


Testaus


<img width="389" height="91" alt="image" src="https://github.com/user-attachments/assets/2509d1ed-c6e1-41ac-85d7-f93e9b964e67" />


Nyt se tulostaa oikean ja väärän viestin ja ei kaadu

Tähänki on varmasti hienompia ratkaisuja, katson niitä jos riittää aikaa palata.












  


  
  b) Lab2. Selvitä salasana ja lippu + kirjoita raportti siitä miten aukesi. lab2.zip
  Latasin lab2 ja unzippasin sen.

  Seurasin README.md ohjeita

  Micro on kalilla jo valmiiksi asennettuna joten

    /.passtr

<img width="423" height="146" alt="image" src="https://github.com/user-attachments/assets/794fd1f2-5149-48d2-b27a-c9517a46a0c8" />

Sieltä tuli jo tuttu "What's the password?"

Ensimmäiseksi tuli mieleen käyttää strings, file ja Ghidraa, mutta readmessä sanottiin, että yritä käyttää debuggeria, joten siitä aloitin

<img width="632" height="463" alt="image" src="https://github.com/user-attachments/assets/b906def1-09f8-418a-a718-2b4e874b9121" />

Tässä ei ole lähdekoodia joten menee jännäksi. Kokeilin ensiksi samaa kuin  eli break main

<img width="636" height="323" alt="image" src="https://github.com/user-attachments/assets/49db3bae-b34f-4bfe-b7d6-e75efca2aa69" />

Main functio löytyy, paha sanoa muuta (cannot find bounds of current functio on kiinnostava.)

Se ei paljastanut minulle hirveästi niin kokeilin disasemble komentoa jota käytettiin tunnilla


<img width="674" height="709" alt="image" src="https://github.com/user-attachments/assets/3b7ed59a-9d0d-4582-9711-a038188503f1" />

Paljon tietoa, aika vaikea tulkita.

Siellä on kuitenkin tutut rekisterit kuten rsi and rdx, joten tutkin niitä ensiksi.

Palasin seuraavan päivänä asiaan. Ennen kuin lähdin huomasin että puretussa koodissa on jne joka hyppää mainiin kohtaan 153 jossa on xor ohje ja rekisterit %eax ja %eax.

Lisäksi minua alkoi kiinnostamaan functio mAsdf3a. Muut functiot olivat selkeitä, tämä oli hämärä. Joten kävin katsomassa

<img width="676" height="616" alt="kuva" src="https://github.com/user-attachments/assets/3b367db4-b6b8-4a35-9929-f76f8e042181" />


käytin break mAsdf3a


<img width="691" height="680" alt="kuva" src="https://github.com/user-attachments/assets/fb6d5589-adc6-4a34-80c3-9874737a2985" />



tulostamalla x/s tulee "anLTj4u8"

ja toisesta mitä syötin eli se vertaa niitä jolla logiikalla.


Käytin komentoa 

    info registers




rdi = anLTj4u8
rsi = käyttäjän syöte


Muut rekisterit eivät kertoneet mitään, viittasivat kohtaan 0x0 tai viittaisivat samaan kuin rdi ja rsi

Oletan, että anLTj4u8 on salasana, kysymys on, että missä muodossa.

Piti yrittää kokeilla sitä sellaisenaan

<img width="424" height="117" alt="kuva" src="https://github.com/user-attachments/assets/f7cee494-eb6e-40b6-a9a0-c778b6eb0bf7" />

Ei toiminut (tietenkin), mutta uskon, että olin oikealla jäljellä.

Kävin katsomassa uudestaan functioita main ja  mAsdf3a

mAsdf3a:

strlen = vertaa pituutta, tarvitaan oikean salasanan vahvistamiseen

Siellä on myös sub ja add, joten salasanasta lisätään tai vähennetään. 

sekä test ja cmp

Uskon, että ohjelma toimii näin:

- Se lataa oikean salasanan "anLTj4u8" muistiin
- Kysyy syötettä
- lisää 3 jos jako menee tasan tai vähentää 7 jos ei mene
- vertaa muutettua syötettä "oikeaan" salasanaan


 | Oikea salasana | ASCII  | Muutos                   | Lopputulos (ASCII)  | Syötetty salasana|
|---------------|------------|------------------------|--------------------|-------------------|
| `a`            | 97          | parillinen +3        | 100                | `d`               |
| `n`            | 110         | pariton −7           | 103                | `g`               |
| `L`            | 76          | parillinen +3        | 79                 | `O`               |
| `T`            | 84          | pariton −7           | 77                 | `M`               |
| `j`            | 106         | parillinen +3        | 109                | `m`               |
| `4`            | 52          | pariton −7           | 45                 | `-`               |
| `u`            | 117         | parillinen → +3      | 120                | `x`               |
| `8`            | 56          | pariton → −7         | 49                 | `1`               |




Syötin salasanan 

    dgOMm-xi


<img width="637" height="78" alt="kuva" src="https://github.com/user-attachments/assets/2bd76c9a-f404-467d-bf3a-84eb7e618cd9" />



Ja sieltä tuli lippu

salasana: dgOMm-xi

Lippu: FLAG{Lari-rsvRDx04WMBZpuwg4qfYwzdcvVa0oym}




  
  c) Lab3. Kokeile Nora Crackmes harjoituksia tehtävä 3 ja 4 ja loput vapaaehtoisia. Tindall 2023: NoraCodes / crackmes.

  käynnistin tehtävän 3 

    gdb crackme03.64
    break main
    disassemble main


<img width="679" height="687" alt="kuva" src="https://github.com/user-attachments/assets/1306b72f-0e52-4097-87da-b5102e507f00" />



sieltä näkyi check_pw function, joka vaikutti mielenkiintoiselta joten tein saman kuin mainille


<img width="561" height="305" alt="kuva" src="https://github.com/user-attachments/assets/a9a29692-59fb-439d-89c6-d9871aeb308b" />




  
  d) Lab4. Vapaaehtoinen: Crackmes.one harjoitus. Saatko salasanan selville? lab4.zip Moodlessa.


  ## Lähteet


  https://theasciicode.com.ar/

  https://www.godevtool.com/GoasmHelp/newass.htm

  https://www.aldeid.com/wiki/X86-assembly/Instructions/sub
