  x) Lue/katso/kuuntele ja tiivistä. (Tässä x-alakohdassa ei tarvitse tehdä testejä tietokoneella, vain lukeminen tai kuunteleminen ja tiivistelmä riittää. Tiivistämiseen riittää muutama ranskalainen viiva.)
        Hammond 2022: Ghidra for Reverse Engineering (PicoCTF 2022 #42 'bbbloat') (Video, noin 20 min)

- Ghidralla voi analysoida binäärejä ja sitä käytiin videolla ratkaistiin Picoctf:än tehtävä
- Videolla avattiin tiedosto ghidralla, siinä löydettiin halutut koodin pätkät kohdasta Windows, Defined strings joka tuo listan määritellyistä stringeistä koodissa
  



a) Asenna Ghidra.
Vaihdoin tässä tehtävässä vihdoin debianista kaliin. Yritin tunnilla asentaa sitä, mutta se oli turhan monimutkaista. Asensin Kali ja 

    sudo apt-get update
    sudo apt-get install ghidra
    ghidra


Sain ghidran käyntiin. Lisäksi Kalissa on muita työkaluja, josta on varmasti hyötyä tulevaisuudessa


b) rever-C. Käänteismallinna packd-binääri C-kielelle Ghidralla. Etsi pääohjelma. Anna muuttujielle kuvaavat nimet. Selitä ohjelman toiminta. Ratkaise tehtävä binääristä, ilman alkuperäistä lähdekoodia. ezbin-challenges.zip

Latasin ezbin-challenges.zip, unzippasin sen ja avasin sen Ghidralla. 

<img width="1409" height="730" alt="kuva" src="https://github.com/user-attachments/assets/efbc5300-66ea-47ee-903e-3f8ccac72d9a" />

Analysoin ja menin kohtaan functions joka on symbol tree:n alla

<img width="247" height="262" alt="kuva" src="https://github.com/user-attachments/assets/51fc8b92-e5ca-486c-b814-4fdda3f7577c" />

Sieltä aloin tutkimaan functiota. 

Tuijotin functioita liiankin pitkään ja koetin etsiä main functiota niiden tekstistä. Sitten tajusin, että siitä ei saa mitään selvää, koska sehän on pakattu. 

Joten uusi yritys. 

Kalilla on jo UPX ladattu eli tarvitsee vain 

    upx -d packd

Poistin varmuudeksi packd tiedoston ja importtasin sen uudestaan. 


<img width="313" height="384" alt="kuva" src="https://github.com/user-attachments/assets/c75faed1-f7ba-4f7a-b5cd-d4087249b129" />

Ja nyt näkyy enemmän ihmisille luettavaa tekstiä.

Menin main functioon. valitsin kohdasta Window, Decompile (ctrl + e shortcut)


<img width="618" height="342" alt="kuva" src="https://github.com/user-attachments/assets/582b14d1-0b83-42ef-99fc-ca09fda2dc6c" />

Aloin siistimään (Kopioin alkuperäisen microon ja muokkasin siellä ihan varmuuden vuoksi)



<img width="1384" height="427" alt="kuva" src="https://github.com/user-attachments/assets/c17d2852-9724-470c-98a6-89d9ff192d79" />


    undefined8 main(void)

sama kuin int main (void), undefined8 on vain placeholder (Netistä ei löydy mitään hyvää käännöstä sanalle placeholder, kertokaa jos keksitte jonkun hyvän

      {
      int cmp;

Määrittää kokonaisluku muuttujan, jota käytetään vertaamiseen kohdassa strcmp


      char passwd [32];
    
Määrittää merkkijonon jonka koko on 32 tavua

      puts("What's the password?");

Kutsuu functiota puts(), joka kysyy "What's the password?" ja se kysyy ja tulostaa syötetyn merkkijonon

    __isoc99_scanf(&DAT_0010201d,local_28);
    cmp = strcmp(passwd,"piilos-AnAnAs");

Aiemmin määritelty muuttuja muutetaan functioksi strcmp joka vertaa kahta eri stringiä


    if (cmp == 0) {
    puts("Yes! That's the password. FLAG{Tero-0e3bed0a89d8851da933c64fefad4ff2}");
    }

Jos käyttäjän syötetty merkkijono on sama kuin piilos-AnAnAs, niin ohjelma tulostaa "Yes! That's the password. FLAG{Tero-0e3bed0a89d8851da933c64fefad4ff2}"



    else {
    puts("Sorry, no bonus.");
    }

Jos syöte on mitä tahansa muuta niin tulostaa Sorry, no bonus.

End of the else block.

    return 0;


  }

Palauttaa nollan jos ohjelma päättyy normaalisti.


Salasana on siis piilos-AnAnAs

ja lippu FLAG{Tero-0e3bed0a89d8851da933c64fefad4ff2}");

Vähän epäselväksi jäi, että kuinka paljon tuollaista koodia voi muokkata ennen kuin se hajoaa/ ei compilaa oikein





c) Jos väärinpäin. Muokkaa passtr-ohjelman binääriä (ilman alkuperäistä lähdekoodia) niin, että se hyväksyy kaikki salasanat paitsi oikean. Osoita testein, että ohjelma toimii. ezbin-challenges.zip



Tunnilla käytiin Ghidran käyttöä, siitä muistan että  
Nykykoodi on: Vertaa syötetty salasana oikeaan salasanaan: jos sama, päästä sisään, jos ei niin älä päästä sisään.
Kun sen kääntää niin se on: jos sama, älä päästä sisään, jos ei, päästä sisään.

Se muistaakseni tunnilta tehtiin vaihtamalla JNZ JN:nnään

Importtasin passtr

<img width="524" height="303" alt="kuva" src="https://github.com/user-attachments/assets/6fa2b560-a7de-4618-982b-7bb0329d60a1" />


Varmistin vielä asian googlamalla "Ghidra JNZ"

Sieltä tuli erittäin kattava ja laadukas [blogi](https://jorianwoltjer.com/blog/p/stories/introduction-to-reverse-engineering-with-ghidra#3-changing-instructions-with-ghidra
) 

d) Nora CrackMe: Käännä binääreiksi Tindall 2023: NoraCodes / crackmes. Lue README.md: älä katso lähdekoodeja, ellet tarvitse niitä apupyöriksi. Näissä tehtävissä binäärejä käänteismallinnetaan. Binäärejä ei muokata, koska muutenhan jokaisen tehtävän ratkaisu olisi vaihtaa palautusarvoksi "return 0".
e) Nora crackme01. Ratkaise binääri.
e) Nora crackme01e. Ratkaise binääri.
f) Nora crackme02. Nimeä pääohjelman muuttujat käänteismallinnetusta binääristä ja selitä ohjelman toiminta. Ratkaise binääri.
g) Vapaaehtoinen: Ja sen yli. Crackme01 on useampia ratkaisuja. Montako löydät? Miksi?
h) Vapaaehtoinen: Pyytämättäkin. Crackme02 on kaksi ratkaisua. Löydätkö molemmat?
i) Vapaaehtoinen, hieman haastavampi: A ray. Nora crackme02e. Ratkaise binääri.



## Lähteet

https://terokarvinen.com

https://terokarvinen.com/sovellusten-hakkerointi/#h4-kaantopaikka-tero



https://jorianwoltjer.com/blog/p/stories/introduction-to-reverse-engineering-with-ghidra#3-changing-instructions-with-ghidra
